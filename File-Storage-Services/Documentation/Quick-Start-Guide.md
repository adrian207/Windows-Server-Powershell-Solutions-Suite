# File and Storage Services PowerShell Scripts - Quick Start Guide

**Author:** Adrian Johnson <adrian207@gmail.com>  
**Version:** 1.0.0  
**Last updated:** 2025-10-26

## Overview

This quick start guide will help you get up and running with the File and Storage Services PowerShell scripts in minutes. The scripts are designed to be modular, portable, and easy to use in any Windows Server environment.

## Prerequisites

Before you begin, ensure you have:

- Windows Server 2016 or later
- PowerShell 5.1 or later
- Administrator privileges
- File and Storage Services role
- Network connectivity

## Installation

### Step 1: Download and Extract

1. Download the File-Storage-Services package
2. Extract to a location of your choice (e.g., `C:\Scripts\File-Storage-Services`)
3. Open PowerShell as Administrator
4. Navigate to the extracted folder

```powershell
cd C:\Scripts\File-Storage-Services
```

### Step 2: Import Core Module

```powershell
Import-Module .\Modules\FileStorage-Core.psm1
```

### Step 3: Check Prerequisites

```powershell
Test-FileStoragePrerequisites
```

If prerequisites are not met, install them:

```powershell
Install-FileStoragePrerequisites
```

## Quick Installation

### Basic File Server Installation

For a basic file server installation with security best practices:

```powershell
# Install file server with SMB 3.0, signing, and encryption
.\Scripts\FileServer\Install-FileServer.ps1 -DomainName "contoso.com" -EnableSMB3 -RequireSigning -EnableEncryption
```

### Advanced File Server Installation

For a comprehensive installation with all features:

```powershell
# Install with FSRM, DFS, and NFS
.\Scripts\FileServer\Install-FileServer.ps1 -DomainName "contoso.com" -EnableSMB3 -RequireSigning -EnableEncryption -EnableFSRM -EnableDFS -EnableNFS
```

## Verification

After installation, verify that the file server is working correctly:

```powershell
# Check overall status
Get-FileServerStatus

# Perform health check
Test-FileServerHealth

# Get storage information
Get-StorageInformation
```

## Common Operations

### Create File Shares

```powershell
# Create a basic data share
.\Scripts\FileSharing\Manage-FileShares.ps1 -Action Create -ShareName "Data" -Path "C:\Shares\Data" -Description "Data Share" -FullAccess @("Administrators") -ReadAccess @("Users")

# Create a share with advanced features
.\Scripts\FileSharing\Manage-FileShares.ps1 -Action Create -ShareName "Projects" -Path "C:\Shares\Projects" -Description "Projects Share" -FullAccess @("Administrators") -ReadAccess @("Users") -EnableAccessBasedEnumeration -EnableOfflineFiles
```

### Manage File Shares

```powershell
# Configure existing share
.\Scripts\FileSharing\Manage-FileShares.ps1 -Action Configure -ShareName "Data" -EnableAccessBasedEnumeration -EnableOfflineFiles -CachingMode "Documents"

# Generate share report
.\Scripts\FileSharing\Manage-FileShares.ps1 -Action Report -OutputPath "C:\Reports\FileShares.html" -IncludePermissions -IncludeUsage

# Backup share configuration
.\Scripts\FileSharing\Manage-FileShares.ps1 -Action Backup -OutputPath "C:\Backups\FileShares.xml"
```

### Storage Management

```powershell
# Get storage information
$storageInfo = Get-StorageInformation
$storageInfo.Disks | Format-Table FriendlyName, Size, OperationalStatus
$storageInfo.Volumes | Format-Table DriveLetter, FileSystemLabel, Size, SizeRemaining

# Create storage pool
$disks = Get-PhysicalDisk | Where-Object { $_.CanPool -eq $true }
New-StoragePool -FriendlyName "DataPool" -StorageSubSystemFriendlyName "Windows Storage*" -PhysicalDisks $disks

# Create storage space
New-VirtualDisk -StoragePoolFriendlyName "DataPool" -FriendlyName "DataSpace" -Size 1TB -ResiliencySettingName "Mirror"
```

## Troubleshooting

### Common Issues

1. **Services not starting**
   ```powershell
   Start-FileServerServices
   ```

2. **Cannot access shares**
   ```powershell
   # Check share status
   Get-SmbShare | Format-Table Name, ShareState, Path
   
   # Check permissions
   Get-SmbShareAccess -Name "ShareName"
   ```

3. **Performance issues**
   ```powershell
   # Check disk performance
   Get-Counter -Counter "\PhysicalDisk(*)\Avg. Disk Queue Length" -SampleInterval 1 -MaxSamples 5
   
   # Check SMB performance
   Get-Counter -Counter "\Server\Sessions Logged On" -SampleInterval 1 -MaxSamples 5
   ```

### Getting Help

1. Check the logs generated by the scripts
2. Review the User Guide in the Documentation folder
3. Use the diagnostic tools provided
4. Check Windows Event Logs for additional information

## Next Steps

1. **Set up monitoring**: Configure continuous health monitoring
2. **Create backups**: Set up regular configuration backups
3. **Document configuration**: Keep records of your file server setup
4. **Train staff**: Ensure your team knows how to use the scripts

## Security Best Practices

- Always use SMB 3.0 or later
- Enable SMB signing and encryption
- Use principle of least privilege for permissions
- Regularly audit share permissions
- Monitor access logs
- Keep Windows and file server components updated

## Performance Optimization

- Use appropriate RAID levels for your storage
- Implement storage tiering for better performance
- Configure deduplication to save space
- Monitor storage performance regularly
- Use BranchCache for remote offices
- Optimize SMB settings for your environment

## Support

For additional help:

1. Review the comprehensive User Guide
2. Check the Examples folder for practical scenarios
3. Use the built-in help for each script:
   ```powershell
   Get-Help .\Scripts\FileServer\Install-FileServer.ps1 -Full
   ```

## Conclusion

You should now have a working file server installation. The scripts provide ongoing management capabilities for configuration, monitoring, and troubleshooting. Refer to the User Guide for advanced usage scenarios and best practices.
